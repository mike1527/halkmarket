<div class="content__inner">
  <div class="content__inner-box">
    <div class="content__body">

      {{ header }}

      <script src="catalog/view/javascript/jquery/jquery-3.5.1.min.js" type="text/javascript"></script>
      <link href="catalog/view/javascript/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen" />
      <link href="catalog/view/javascript/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
      <link href="catalog/view/theme/default/stylesheet/global.css" rel="stylesheet">
      <link href="catalog/view/theme/default/stylesheet/fonts.css" rel="stylesheet">

      {% for link in links %}
      <link href="{{ link.href }}" rel="{{ link.rel }}" />
      {% endfor %}
      {% for analytic in analytics %}
      {{ analytic }}
      {% endfor %}
      {% for script in scripts %}
      <script src="{{ script }}" type="text/javascript"></script>
      {% endfor %}
      <script src="catalog/view/javascript/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
      {% for script in scripts %}
      <script src="{{ script }}" type="text/javascript"></script>
      {% endfor %}
      <script src="catalog/view/javascript/common.js" type="text/javascript"></script>

        <div id="product-manufacturer" class="container">

          <ul class="breadcrumb breadcrumb__list">
          {% for key, breadcrumb in breadcrumbs %}
          {% if key + 1 < breadcrumbs|length %}
          <li class="breadcrumb__item breadcrumb__item-hover"><a class="breadcrumb__link" href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
          {% else %}
          <li class="breadcrumb__item">{{ breadcrumb.text }}</li>
          {% endif %}
          {% endfor %}
          </ul>

          <div class="row">{{ column_left }}
          {% if column_left and column_right %}
          {% set class = 'col-sm-6' %}
          {% elseif column_left or column_right %}
          {% set class = 'col-sm-9' %}
          {% else %}
          {% set class = 'col-sm-12' %}
          {% endif %}
          <div id="content" class="container">{{ content_top }}
            <h1 class="partner__title">{{ text_partner_title }}</h1>

              <div class="partners__wrapper">

                  {% if categories %}
                  {% for category in categories %}
    {#            <h2 id="{{ category.name }}">{{ category.name }}</h2>#}
                  {% if category.manufacturer %}
                  {% for manufacturers in category.manufacturer|batch(4) %}
                  {% for manufacturer in manufacturers %}
  {#                <div class="partners__item">#}
                    <a class="partners__item-link" href="{{ manufacturer.href }}">
                      {#                  {{ manufacturer.name }}#}
                      <img class="partners__item-img" src="{{ manufacturer.thumb }}" alt="">
                    </a>
  {#                </div>#}
                  {% endfor %}
                  {% endfor %}
                  {% endif %}
                  {% endfor %}

              </div>

          </div>

            {% else %}
            <p>{{ text_empty }}</p>
            <div class="buttons clearfix">
              <div class="pull-right"><a href="{{ continue }}" class="btn btn-primary">{{ button_continue }}</a></div>
            </div>
            {% endif %}


          </div>
          </div>

          <div class="partners__link">
            <a href="#form-popup-manufacture" class="partners__link-btn popup-manufacture-form">
              {{ text_partners_link }}
            </a>
          </div>

          <div id="form-popup-manufacture" class="popup-box mfp-hide">
            <form class="popup__form" enctype="multipart/form-data" method="post" id="formManufacture" onsubmit="send(event, 'send-manufacture-form.php')">
              <a class="close__btn" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="close__btn">
                  <use xlink:href="/img/icon/sprite.svg#CloseBtn"></use>
                </svg>
              </a>

              <h3 class="popup__form-message">Хочу сотрудничать с Халкмаркетом</h3>

              <div class="sendMsgManufacture" onclick="gsapMessage.reverse()"></div>

              <div class="form-group required form__group-item">
{#                <label class="control-label register__label-name" for="input-firstname">Имя</label>#}
                <div class="register__input">
                  <input type="text" name="firstname" value="" placeholder="Введите свое имя" id="firstname" class="form-control form-control__manufacture-popup" required>
                  <svg xmlns="http://www.w3.org/2000/svg" class="account__svg name__svg">
                    <use xlink:href="/img/icon/sprite.svg#AccountUser"></use>
                  </svg>
                </div>
              </div>

              <div class="form-group required form__group-item">
{#                <label class="control-label register__label-name" for="input-lastname">Фамилия</label>#}
                <div class="register__input">
                  <input type="text" name="lastname" value="" placeholder="Введите свою фамилию" id="lastname" class="form-control form-control__manufacture-popup" required>
                  <svg xmlns="http://www.w3.org/2000/svg" class="account__svg name__svg">
                    <use xlink:href="/img/icon/sprite.svg#AccountUser"></use>
                  </svg>
                </div>
              </div>

              <div class="form-group required form__group-item">
{#                <label class="control-label register__label-name" for="input-email">E-Mail</label>#}
                <div class="register__input">
                  <input type="email" name="email" value="" placeholder="Введите эл-почту" id="email" class="form-control form-control__manufacture-popup" required>
                  <svg xmlns="http://www.w3.org/2000/svg" class="account__svg message__svg">
                    <use xlink:href="/img/icon/sprite.svg#MessageRegister"></use>
                  </svg>
                </div>
              </div>

              <div class="form-group required form__group-item">
{#                <label class="control-label register__label-name" for="input-telephone">Тел (+993)</label>#}
                <div class="register__input">
                  <input type="tel" name="phone" value="" placeholder="Введите номер телефона (+993)" id="phone" class="form-control form-control__manufacture-popup" required>
                  <svg xmlns="http://www.w3.org/2000/svg" class="account__svg telephone__svg">
                    <use xlink:href="/img/icon/sprite.svg#TelephoneRegister"></use>
                  </svg>
                </div>
              </div>

              <div class="message__box">
                <svg xmlns="http://www.w3.org/2000/svg" class="textarea__mess-icon">
                  <use xlink:href="/img/icon/sprite.svg#MessageTextarea"></use>
                </svg>
                <textarea name="message" id="message" class="inputbox" required></textarea>
              </div>

              <div class="popup__form-btn">
                <button class="popup__form-btn" type="submit" value="Отправить">Отправить</button>
              </div>

            </form>

          </div>

      </div>


    <div class="content__footer">
      {{ footer }}
    </div>

  </div>

</div>

<script>
  $('.popup-manufacture-form').magnificPopup({
    type: 'inline',
    focus: '#message',
    // type: 'ajax',
    midClick: true,
    mainClass: 'mfp-fade',
    closeOnBgClick: false
  });

  $(document).on('click', '.close__btn', function(e) {
    e.preventDefault();
    $.magnificPopup.close();
  });
</script>

<script src="catalog/view/javascript/gsapmanufacture.min.js"></script>

<script>
  // Объявления
  let msg = document.querySelector(".sendMsgManufacture");
  let gsapMessage = gsap.to(".sendMsgManufacture", 0.25, {autoAlpha: 1,y: -40,ease: Expo.inOut, paused: true});
  let arrInputTest = document.querySelectorAll('.aInputTest');

  // Функция отправки сообщения
  function send(event, php){
    event.preventDefault ? event.preventDefault() : event.returnValue = false;
    for (let i = 0,count=arrInputTest.length; i<count; i++) {arrInputTest[i].classList.remove("errorInput");}
    event.target.querySelector("button").disabled = true;
    showMessage("Подождите. Идёт отправка сообщения", "#b1b1b1");
    let reqtest = new XMLHttpRequest();
    reqtest.open('POST', php, true);
    reqtest.onload = function() {
      event.target.querySelector("button").disabled = false;

      if (reqtest.status >= 200 && reqtest.status < 400) {
        json = JSON.parse(this.response);
        console.log(json);

        // ЗДЕСЬ УКАЗЫВАЕМ ДЕЙСТВИЯ В СЛУЧАЕ УСПЕХА ИЛИ НЕУДАЧИ
        if (json.result == "success") {
          // если сообщение отправлено
          showMessage("Сообщение успешно отправлено", "#3B245A");
          console.log("Сообщение отправлено");
          event.target.reset();
        } else if(json.result == "email") {
          // Если указан неверный email
          showMessage("Ошибка. Неверно указан Email", "#DC352F");
          console.log("Ошибка. Неверно указан Email");
          document.querySelector("#email").classList.add("inputerror");
        } else {
          // Если произошла ошибка
          showMessage("Ошибка. Сообщение не отправлено", "#DC352F");
          console.log("Ошибка. Сообщение не отправлено");
        }

        // Если не удалось связаться с php файлом
      } else {showMessage("Ошибка сервера. Номер: "+reqtest.status, "#DC352F");}};

// Если не удалось отправить запрос. Стоит блок на хостинге
    reqtest.onerror = function() {showMessage("Ошибка отправки запроса", "#DC352F");};
    reqtest.send(new FormData(event.target));
  }

  // Функция появления статуса отправки сообщения
  function showMessage(messagetest, color) {
    msg.innerText = messagetest;
    msg.style.background = color;
    gsapMessage.restart();
  }

</script>


